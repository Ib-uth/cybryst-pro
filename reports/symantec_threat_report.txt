SYMANTEC THREAT INTELLIGENCE
GLOBAL THREAT LANDSCAPE REPORT
==============================

THREAT ACTOR: Lazarus Group (Hidden Cobra)
CAMPAIGN: Cryptocurrency Exchange Targeting
DATE: July 20, 2024
THREAT LEVEL: CRITICAL

EXECUTIVE SUMMARY
Symantec's Threat Intelligence team has uncovered a sophisticated cryptocurrency exchange targeting campaign by the Lazarus Group. This campaign demonstrates advanced evasion techniques, multi-stage payload delivery, and sophisticated social engineering tactics specifically designed to compromise cryptocurrency trading platforms and steal digital assets.

CAMPAIGN ANALYSIS

TARGETING STRATEGY
Primary Targets:
- Cryptocurrency exchanges (Binance, Coinbase, Kraken)
- DeFi (Decentralized Finance) platforms
- Cryptocurrency wallet providers
- Blockchain development companies
- Financial technology startups

Attack Vectors:
1. Watering Hole Attacks
   - Compromising cryptocurrency news websites
   - Malicious advertisements on trading platforms
   - Supply chain attacks on wallet software

2. Social Engineering
   - Fake job postings for blockchain developers
   - Phishing emails impersonating exchange support
   - Malicious GitHub repositories

3. Zero-Day Exploits
   - Browser vulnerabilities (Chrome, Firefox, Safari)
   - Operating system exploits (Windows, macOS, Linux)
   - Mobile application vulnerabilities

MALWARE FAMILY ANALYSIS

LAZARUS RAT (Remote Access Trojan)
Primary Payload:
- File Name: blockchain_sync.exe
- SHA256: 8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1
- MD5: c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6
- File Size: 4,567,890 bytes
- Compilation Date: 2024-07-15 09:45:33 UTC

Capabilities:
- Keylogging and screen capture
- File system enumeration
- Network reconnaissance
- Credential harvesting
- Cryptocurrency wallet access

Persistence Mechanisms:
- Registry Run Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\BlockchainSync
- Scheduled Task: "CryptoWalletSync"
- Service Installation: "BlockchainService"
- DLL Hijacking: crypt32.dll

ADVANCED EVASION TECHNIQUES

ANTI-VM AND ANTI-SANDBOX
Virtual Machine Detection:
- Check for VMWare registry keys and processes
- Detect VirtualBox and Hyper-V environments
- CPU instruction timing analysis
- Memory size and configuration checks

Sandbox Evasion:
- Sleep loops with random delays (10-30 minutes)
- User interaction requirements (mouse movement, keyboard input)
- File system activity simulation
- Network connectivity validation

Debugger Detection:
- IsDebuggerPresent API calls
- Hardware breakpoint detection
- Timing-based analysis
- Exception handling manipulation

PROCESS INJECTION METHODS
Atom Bombing:
- Using Windows Atom Tables for injection
- Global atom name: "CRYPTO_WALLET_SYNC"
- Target process: explorer.exe

Process Doppelg√§nging:
- Transaction-based process injection
- Using NTFS transactions for stealth
- Rollback after successful injection

Hollow Process Injection:
- Target process: svchost.exe
- Injection method: Process Hollowing
- Payload: crypto_monitor.dll

CRYPTOCURRENCY TARGETING

WALLET COMPROMISE TECHNIQUES
Browser Extension Targeting:
- Chrome: MetaMask, Trust Wallet, Coinbase Wallet
- Firefox: MetaMask, Brave Wallet
- Edge: MetaMask, Trust Wallet

Desktop Wallet Targeting:
- Electrum, Exodus, Atomic Wallet
- Ledger Live, Trezor Suite
- Bitcoin Core, Ethereum Geth

Mobile Wallet Targeting:
- Trust Wallet, Coinbase Wallet
- MetaMask Mobile, Rainbow
- Hardware wallet companion apps

PRIVATE KEY EXTRACTION
Methods:
- Memory scanning for private keys
- File system enumeration for wallet files
- Browser storage access
- Clipboard monitoring for copied keys

Target File Types:
- wallet.dat (Bitcoin Core)
- keystore files (Ethereum)
- Private key files (.key, .pem)
- Seed phrase files (mnemonic.txt)

CRYPTOCURRENCY THEFT
Stolen Assets:
- Bitcoin: 1,234.56789012 BTC
- Ethereum: 5,678.90123456 ETH
- Binance Coin: 12,345.67890123 BNB
- Various altcoins: $2.5M USD value

Transfer Methods:
- Direct wallet-to-wallet transfers
- Exchange account takeovers
- DeFi protocol exploitation
- Cross-chain bridge attacks

NETWORK COMMUNICATION

COMMAND AND CONTROL INFRASTRUCTURE
Primary C2 Servers:
- IP Address: 91.92.240.118 (Russia)
- Port: 443 (HTTPS)
- Domain: crypto-sync.legitimate-site.com
- SSL Certificate: DigiCert (Issued: 2024-07-01)

Secondary C2 Servers:
- IP Address: 185.220.101.42 (Germany)
- Port: 8080 (HTTP)
- Domain: blockchain-update.net
- Backup Domain: wallet-sync.org

Communication Protocol:
- HTTP/HTTPS POST requests
- JSON-encoded payloads
- AES-256 encryption
- Base64 encoding with custom alphabet

Data Exfiltration:
- Cryptocurrency wallet files
- Private keys and seed phrases
- Trading account credentials
- Transaction history data

ADVANCED PERSISTENCE MECHANISMS

ROOTKIT FUNCTIONALITY
Bootkit Installation:
- MBR (Master Boot Record) modification
- VBR (Volume Boot Record) infection
- Boot sector modification
- UEFI firmware targeting

Kernel-Level Persistence:
- Driver installation
- SSDT (System Service Descriptor Table) hooking
- IRP (I/O Request Packet) interception
- Process creation monitoring

User-Mode Persistence:
- DLL injection into critical processes
- COM object hijacking
- Windows service installation
- Scheduled task creation

LATERAL MOVEMENT TECHNIQUES

NETWORK DISCOVERY
Active Scanning:
- ARP table enumeration
- Port scanning (TCP 445, 3389, 22, 5985)
- Service enumeration
- Share discovery

Passive Reconnaissance:
- Network traffic analysis
- DNS query monitoring
- SNMP information gathering
- LLMNR/NBT-NS poisoning

CREDENTIAL HARVESTING
Methods:
- LSASS memory dumping
- Credential manager access
- Browser password extraction
- Keylogger installation

Tools Used:
- Mimikatz for credential dumping
- LaZagne for password recovery
- Browser password extractors
- Custom keylogging modules

INDICATORS OF COMPROMISE (IOCs)

FILE HASHES
Malicious Files:
- blockchain_sync.exe: SHA256: 8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1
- crypto_monitor.dll: SHA256: 7f8e9a2b4c6d1e3f5a7b9c0d2e4f6a8b0c1d3e5f7a9b2c4d6e8f0a1b3c5d7e9f1a2
- wallet_extractor.exe: SHA256: 6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0

Dropped Files:
- %TEMP%\crypto_data.bin
- %APPDATA%\Microsoft\Windows\Themes\wallet.dll
- %PROGRAMDATA%\Windows\System32\drivers\crypto.sys

REGISTRY KEYS
Persistence Keys:
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\BlockchainSync
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
- HKEY_CURRENT_USER\Software\Classes\CLSID\{98765432-5432-5432-5432-321098765432}

Configuration Keys:
- HKEY_CURRENT_USER\Software\CryptoMonitor\Config
- HKEY_LOCAL_MACHINE\SOFTWARE\CryptoMonitor\Settings

NETWORK INDICATORS
IP Addresses:
- 91.92.240.118 (Primary C2)
- 185.220.101.42 (Secondary C2)
- 45.146.164.110 (Backup C2)
- 203.0.113.45 (Exfiltration server)

Domain Names:
- crypto-sync.legitimate-site.com
- blockchain-update.net
- wallet-sync.org
- crypto-monitor.trusted-domain.com

User-Agent Strings:
- Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
- Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0

MITRE ATT&CK MAPPING

INITIAL ACCESS
- T1566.001 - Phishing: Spearphishing Attachment
- T1189 - Drive-by Compromise
- T1190 - Exploit Public-Facing Application

EXECUTION
- T1059.001 - Command and Scripting Interpreter: PowerShell
- T1204.002 - User Execution: Malicious File
- T1055 - Process Injection

PERSISTENCE
- T1543.003 - Create or Modify System Process: Windows Service
- T1053.005 - Scheduled Task/Job: Scheduled Task
- T1547.001 - Boot or Logon Autostart Execution: Registry Run Keys

PRIVILEGE ESCALATION
- T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control
- T1078.003 - Valid Accounts: Local Accounts

DEFENSE EVASION
- T1562.001 - Impair Defenses: Disable or Modify Tools
- T1027 - Obfuscated Files or Information
- T1055 - Process Injection

CREDENTIAL ACCESS
- T1003.001 - OS Credential Dumping: LSASS Memory
- T1552.001 - Unsecured Credentials: Credentials in Files

DISCOVERY
- T1083 - File and Directory Discovery
- T1082 - System Information Discovery
- T1018 - Remote System Discovery

LATERAL MOVEMENT
- T1021.001 - Remote Services: Remote Desktop Protocol
- T1021.002 - Remote Services: SMB/Windows Admin Shares
- T1078.003 - Valid Accounts: Local Accounts

COLLECTION
- T1005 - Data from Local System
- T1039 - Data from Network Shared Drive
- T1056.001 - Input Capture: Keylogging

COMMAND AND CONTROL
- T1071.001 - Application Layer Protocol: Web Protocols
- T1573.002 - Encrypted Channel: Asymmetric Cryptography

EXFILTRATION
- T1041 - Exfiltration Over C2 Channel
- T1048.003 - Exfiltration Over Alternative Protocol

IMPACT
- T1486 - Data Encrypted for Impact
- T1499 - Endpoint Denial of Service

DETECTION RECOMMENDATIONS

ENDPOINT DETECTION
Process Monitoring:
- Monitor for process injection techniques
- Alert on suspicious DLL loading
- Track process hollowing activities

File System Monitoring:
- Monitor for cryptocurrency wallet files
- Alert on suspicious file modifications
- Track registry key changes

Network Monitoring:
- Monitor for C2 communication
- Alert on data exfiltration patterns
- Track suspicious DNS queries

SIEM QUERIES
Process Injection Detection:
```kql
DeviceProcessEvents
| where ProcessCommandLine contains "CreateRemoteThread"
| where ProcessCommandLine contains "VirtualAllocEx"
| where ProcessCommandLine contains "WriteProcessMemory"
```

Cryptocurrency File Detection:
```kql
DeviceFileEvents
| where FileName contains "wallet"
| where FileName contains "private"
| where FileName contains "seed"
```

Network Communication:
```kql
DeviceNetworkEvents
| where RemoteIP in ("91.92.240.118", "185.220.101.42", "45.146.164.110")
| where RemotePort in (443, 8080, 53)
```

MITIGATION STRATEGIES

IMMEDIATE ACTIONS
1. Isolate compromised systems
2. Reset all administrative passwords
3. Deploy additional monitoring tools
4. Review and update security policies

LONG-TERM MEASURES
1. Implement network segmentation
2. Deploy advanced endpoint protection
3. Regular security awareness training
4. Continuous security monitoring
5. Regular penetration testing

CONCLUSION
This Lazarus Group campaign represents a significant threat to the cryptocurrency ecosystem. Organizations must implement comprehensive security controls and maintain continuous monitoring to detect and respond to such sophisticated threats.
